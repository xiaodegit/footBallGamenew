{"version":3,"sources":["file:///D:/cocosProject/footBallGame/game/assets/managers/ObstacleManager.ts"],"names":["obstacleManager","Vec3","instantiate","obstacles","getInstance","instance","setobstaclePrefab","prefab","i","push","randomoObstacle","segment","randomx","randomz","positions","x","z","shuffle","array","length","j","Math","floor","random","instantArray","children","addChild","setPosition"],"mappings":";;;qFAIaA,e;;;;;;;;;AAHJC,MAAAA,I,OAAAA,I;AAAcC,MAAAA,W,OAAAA,W;;;;;uFADvB;;;;;iCAIaF,e,GAAN,MAAMA,eAAN,CAAsB;AAAA;AAAA,eAEjBG,SAFiB,GAEL,EAFK;AAAA;;AAIA,eAAXC,WAAW,GAAoB;AACzC,cAAI,CAACJ,eAAe,CAACK,QAArB,EAA+B;AAC3BL,YAAAA,eAAe,CAACK,QAAhB,GAA2B,IAAIL,eAAJ,EAA3B;AACH;;AACD,iBAAOA,eAAe,CAACK,QAAvB;AACH;;AAEDC,QAAAA,iBAAiB,CAACC,MAAD,EAAS;AACtB,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxB,iBAAKL,SAAL,CAAeM,IAAf,CAAoBF,MAAM,CAACC,CAAD,CAA1B;AACH;AACJ,SAfwB,CAgBzB;;;AACAE,QAAAA,eAAe,CAACC,OAAD,EAAU;AAErB;AACA,cAAIC,OAAO,GAAG,CAAC,GAAD,EAAM,CAAN,EAAS,CAAC,GAAV,CAAd;AACA,cAAIC,OAAO,GAAG,CAAC,EAAD,EAAK,CAAL,EAAQ,CAAC,EAAT,CAAd;AACA,cAAIC,SAAsB,GAAG,EAA7B,CALqB,CAOrB;;AACA,eAAK,IAAIC,CAAT,IAAcH,OAAd,EAAuB;AACnB,iBAAK,IAAII,CAAT,IAAcH,OAAd,EAAuB;AACnBC,cAAAA,SAAS,CAACL,IAAV,CAAe,IAAIR,IAAJ,CAASc,CAAT,EAAY,CAAZ,EAAeC,CAAf,CAAf,EADmB,CACiB;AACvC;AACJ,WAZoB,CAcrB;;;AACA,mBAASC,OAAT,CAAiBC,KAAjB,EAAoC;AAChC,iBAAK,IAAIV,CAAC,GAAGU,KAAK,CAACC,MAAN,GAAe,CAA5B,EAA+BX,CAAC,GAAG,CAAnC,EAAsCA,CAAC,EAAvC,EAA2C;AACvC,oBAAMY,CAAC,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,MAAiBf,CAAC,GAAG,CAArB,CAAX,CAAV;AACA,eAACU,KAAK,CAACV,CAAD,CAAN,EAAWU,KAAK,CAACE,CAAD,CAAhB,IAAuB,CAACF,KAAK,CAACE,CAAD,CAAN,EAAWF,KAAK,CAACV,CAAD,CAAhB,CAAvB;AACH;AACJ;;AAEDS,UAAAA,OAAO,CAACH,SAAD,CAAP;;AACA,eAAK,IAAIN,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AACxB,gBAAIU,KAAoB,GAAG,KAAKf,SAAhC;;AAEA,gBAAIe,KAAJ,EAAW;AACP,kBAAIM,YAAY,GAAGtB,WAAW,CAACgB,KAAK,CAACV,CAAD,CAAN,CAA9B;AACAG,cAAAA,OAAO,CAACc,QAAR,CAAiB,CAAjB,EAAoBC,QAApB,CAA6BF,YAA7B;AACAA,cAAAA,YAAY,CAACG,WAAb,CAAyBb,SAAS,CAACN,CAAD,CAAlC,EAHO,CAGkC;AAE5C;AACJ;AACJ;;AAlDwB,O;;AAAhBR,MAAAA,e,CACMK,Q","sourcesContent":["//障碍物全局管理器\r\nimport { Vec3, Prefab, instantiate } from \"cc\";\r\nimport { RoadManager } from \"./RoadManager\";\r\n\r\nexport class obstacleManager {\r\n    private static instance: obstacleManager;\r\n    private obstacles = [];\r\n\r\n    public static getInstance(): obstacleManager {\r\n        if (!obstacleManager.instance) {\r\n            obstacleManager.instance = new obstacleManager();\r\n        }\r\n        return obstacleManager.instance;\r\n    }\r\n\r\n    setobstaclePrefab(prefab) {\r\n        for (let i = 0; i < 4; i++) {\r\n            this.obstacles.push(prefab[i]);\r\n        }\r\n    }\r\n    //随机分配障碍物\r\n    randomoObstacle(segment) {\r\n\r\n        //随机位置 前 中 后 5   0  -5  ,  0  ,  20  0  -20\r\n        let randomx = [5.6, 0, -5.6];\r\n        let randomz = [20, 0, -20];\r\n        let positions: Array<Vec3> = [];\r\n\r\n        // 生成所有位置组合\r\n        for (let x of randomx) {\r\n            for (let z of randomz) {\r\n                positions.push(new Vec3(x, 0, z));  // 假设 Y 轴为 0\r\n            }\r\n        }\r\n\r\n        // 打乱位置\r\n        function shuffle(array: Array<any>) {\r\n            for (let i = array.length - 1; i > 0; i--) {\r\n                const j = Math.floor(Math.random() * (i + 1));\r\n                [array[i], array[j]] = [array[j], array[i]];\r\n            }\r\n        }\r\n\r\n        shuffle(positions);\r\n        for (let i = 0; i < 4; i++) {\r\n            let array: Array<Prefab> = this.obstacles;\r\n\r\n            if (array) {\r\n                let instantArray = instantiate(array[i]);\r\n                segment.children[3].addChild(instantArray);\r\n                instantArray.setPosition(positions[i]);  // 设置随机位置\r\n\r\n            }\r\n        }\r\n    }\r\n    \r\n}"]}