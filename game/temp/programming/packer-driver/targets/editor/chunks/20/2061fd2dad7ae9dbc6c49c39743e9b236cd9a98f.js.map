{"version":3,"sources":["file:///D:/cocosProject/footBallGame/game/assets/controllers/PlayerController.ts"],"names":["_decorator","Component","SkeletalAnimation","RigidBody2D","Vec2","ERigidBody2DType","PlayerManager","ccclass","property","PlayerController","tooltip","jumpBool","recoveryCallback","playerManager","jumpHight","savePlayerVec3","moveBoolean","start","getInstance","rb","getComponent","type","Dynamic","gravityScale","runStart","skeletalAnimation","animState","getState","update","dt","addLeftMovement","vec","movementSpeed","LinearVelocity","addRightMovement","jumpMovement","jump","Impulse","jumpForce","applyImpulseToRigidbody","console","log","e","linearVelocity","m","linearDamping","angularDamping","point","applyLinearImpulse","applyForceToRigidbody","applyForce","playerState","stop","play","stopMovement","angularVelocity"],"mappings":"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","sourcesContent":["//角色控制器\r\nimport { _decorator, Component, SkeletalAnimation, RigidBody2D, Vec2, ERigidBody2DType, BoxCollider2D, PhysicsSystem2D, EPhysics2DDrawFlags } from 'cc';\r\nimport { PlayerManager } from '../managers/PlayerManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('PlayerController')\r\nexport class PlayerController extends Component {\r\n\r\n    @property({\r\n        tooltip: \"移动速度\"\r\n    })\r\n    private movementSpeed = 1;\r\n\r\n    @property(RigidBody2D)\r\n    rb: RigidBody2D | null = null;\r\n\r\n    @property({\r\n        tooltip: \"跳跃力\"\r\n    })\r\n    jumpForce: number = 1;\r\n    private jumpBool;\r\n\r\n    private recoveryCallback: Function = null;\r\n    private playerManager: PlayerManager;\r\n    private jumpHight: number;\r\n    public savePlayerVec3: Vec2;\r\n    private moveBoolean = false;\r\n    start() {\r\n        this.playerManager = PlayerManager.getInstance();\r\n        this.rb = this.getComponent(RigidBody2D);\r\n        this.rb.type = ERigidBody2DType.Dynamic;\r\n        this.rb.gravityScale = 9.8;\r\n        // // 启用物理系统的调试绘制\r\n        // PhysicsSystem2D.instance.debugDrawFlags =\r\n        //     EPhysics2DDrawFlags.Aabb |\r\n        //     EPhysics2DDrawFlags.Pair |\r\n        //     EPhysics2DDrawFlags.CenterOfMass |\r\n        //     EPhysics2DDrawFlags.Joint |\r\n        //     EPhysics2DDrawFlags.Shape;\r\n\r\n    }\r\n\r\n    //向前推加速度-开跑 \r\n    runStart() {\r\n        const skeletalAnimation = this.getComponent(SkeletalAnimation);\r\n        const animState = skeletalAnimation.getState('Take 001');\r\n    }\r\n\r\n    update(dt) {\r\n        if (!this.moveBoolean) {\r\n            // this.stopMovement()\r\n        }\r\n    }\r\n\r\n\r\n    //向左\r\n    addLeftMovement() {\r\n        let vec = new Vec2(-this.movementSpeed, 0);\r\n        this.LinearVelocity(vec)\r\n\r\n    }\r\n\r\n    //向右\r\n    addRightMovement() {\r\n        let vec = new Vec2(this.movementSpeed, 0);\r\n        this.LinearVelocity(vec)\r\n\r\n    }\r\n\r\n    //跳跃\r\n    jumpMovement() {\r\n\r\n        if (!this.playerManager.jump) {\r\n            this.playerManager.jump = true;\r\n            let Impulse = new Vec2(0, this.jumpForce);\r\n            this.applyImpulseToRigidbody(Impulse);\r\n            console.log('跳');\r\n\r\n        }\r\n    }\r\n\r\n    //线性加速度\r\n    LinearVelocity(e) {\r\n\r\n        if (this.rb) {\r\n            this.rb.linearVelocity = e;\r\n            this.moveBoolean = true;\r\n        }\r\n    }\r\n\r\n    //瞬间加速度\r\n    applyImpulseToRigidbody(m) {\r\n        this.rb.linearDamping = 0.0;\r\n        this.rb.angularDamping = 0.0;\r\n        let point = new Vec2(0, 0);\r\n        this.rb.applyLinearImpulse(m, point, true);\r\n    }\r\n\r\n    //持续加速度\r\n    applyForceToRigidbody(m) {\r\n        if (!this.rb) return;\r\n        console.log('持续加速度');\r\n        let point = new Vec2(0, 0);\r\n        this.rb.applyForce(m, point, true);\r\n    }\r\n\r\n    //是否播放跑步动画\r\n    playerState() {\r\n        if (this.playerManager.jump) {\r\n            this.getComponent(SkeletalAnimation).stop();\r\n        } else {\r\n            this.getComponent(SkeletalAnimation).play();\r\n        }\r\n    }\r\n\r\n    // 清除物体的速度和角速度，停止运动\r\n    stopMovement() {\r\n        this.rb.linearVelocity = new Vec2(0, 0);\r\n        this.rb.angularVelocity = 0;\r\n        this.rb.linearDamping = 10;\r\n        this.rb.angularDamping = 10;\r\n        // this.rb.sleep();\r\n    }\r\n\r\n}"]}