{"version":3,"sources":["file:///D:/cocosProject/footBallGame/game/assets/controllers/PlayerController.ts"],"names":["_decorator","Component","SkeletalAnimation","RigidBody2D","Vec2","ERigidBody2DType","PlayerManager","ccclass","property","PlayerController","tooltip","movementSpeed","playerManager","savePlayerVec3","moveBoolean","start","getInstance","rb","getComponent","type","Dynamic","gravityScale","runStart","skeletalAnimation","update","addMovement","e","vec","LinearVelocity","jumpMovement","jump","Impulse","jumpForce","applyImpulseToRigidbody","console","log","linearVelocity","m","linearDamping","angularDamping","point","applyLinearImpulse","applyForceToRigidbody","applyForce","playerState","stop","play","stopMovement","angularVelocity","setMovementSpeed"],"mappings":"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","sourcesContent":["//角色控制器\r\nimport { _decorator, Component, SkeletalAnimation, RigidBody2D, Vec2, ERigidBody2DType, BoxCollider2D, PhysicsSystem2D, EPhysics2DDrawFlags } from 'cc';\r\nimport { PlayerManager } from '../managers/PlayerManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('PlayerController')\r\nexport class PlayerController extends Component {\r\n    private movementSpeed = 1;\r\n\r\n    @property(RigidBody2D)\r\n    rb: RigidBody2D | null = null;\r\n\r\n    @property({\r\n        tooltip: \"跳跃力\"\r\n    })\r\n    jumpForce: number = 1;\r\n\r\n    private playerManager: PlayerManager;\r\n    public savePlayerVec3: Vec2;\r\n    private moveBoolean = false;\r\n    start() {\r\n        this.playerManager = PlayerManager.getInstance();\r\n        this.rb = this.getComponent(RigidBody2D);\r\n        this.rb.type = ERigidBody2DType.Dynamic;\r\n        this.rb.gravityScale = 9.8;\r\n        // // 启用物理系统的调试绘制\r\n        // PhysicsSystem2D.instance.debugDrawFlags =\r\n        //     EPhysics2DDrawFlags.Aabb |\r\n        //     EPhysics2DDrawFlags.Pair |\r\n        //     EPhysics2DDrawFlags.CenterOfMass |\r\n        //     EPhysics2DDrawFlags.Joint |\r\n        //     EPhysics2DDrawFlags.Shape;\r\n\r\n    }\r\n\r\n    //向前推加速度-开跑 \r\n    runStart() {\r\n        const skeletalAnimation = this.getComponent(SkeletalAnimation);\r\n    }\r\n\r\n    update() {\r\n        if (!this.moveBoolean) {\r\n            // this.stopMovement()\r\n        }\r\n    }\r\n\r\n\r\n    //向左\r\n    addMovement(e:number) {\r\n        let vec = new Vec2(e, 0);\r\n        this.LinearVelocity(vec)\r\n\r\n    }\r\n\r\n    //跳跃\r\n    jumpMovement() {\r\n\r\n        if (!this.playerManager.jump) {\r\n            this.playerManager.jump = true;\r\n            let Impulse = new Vec2(0, this.jumpForce);\r\n            this.applyImpulseToRigidbody(Impulse);\r\n            console.log('跳');\r\n\r\n        }\r\n    }\r\n\r\n    //线性加速度\r\n    LinearVelocity(e:Vec2) {\r\n\r\n        if (this.rb) {\r\n            this.rb.linearVelocity = e;\r\n            this.moveBoolean = true;\r\n        }\r\n    }\r\n\r\n    //瞬间加速度\r\n    applyImpulseToRigidbody(m:Vec2) {\r\n        this.rb.linearDamping = 0.0;\r\n        this.rb.angularDamping = 0.0;\r\n        let point = new Vec2(0, 0);\r\n        this.rb.applyLinearImpulse(m, point, true);\r\n    }\r\n\r\n    //持续加速度\r\n    applyForceToRigidbody(m:Vec2) {\r\n        if (!this.rb) return;\r\n        console.log('持续加速度');\r\n        let point = new Vec2(0, 0);\r\n        this.rb.applyForce(m, point, true);\r\n    }\r\n\r\n    //是否播放跑步动画\r\n    playerState() {\r\n        if (this.playerManager.jump) {\r\n            this.getComponent(SkeletalAnimation).stop();\r\n        } else {\r\n            this.getComponent(SkeletalAnimation).play();\r\n        }\r\n    }\r\n\r\n    // 清除物体的速度和角速度，停止运动\r\n    stopMovement() {\r\n        this.rb.linearVelocity = new Vec2(0, 0);\r\n        this.rb.angularVelocity = 0;\r\n        this.rb.linearDamping = 10;\r\n        this.rb.angularDamping = 10;\r\n        // this.rb.sleep();\r\n    }\r\n\r\n    setMovementSpeed(e:number){\r\n        this.movementSpeed = e;\r\n    }\r\n}"]}