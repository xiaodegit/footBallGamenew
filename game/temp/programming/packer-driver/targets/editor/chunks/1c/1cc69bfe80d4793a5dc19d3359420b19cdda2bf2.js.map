{"version":3,"sources":["file:///D:/cocosProject/footBallGame/game/assets/managers/RoadManager.ts"],"names":["RoadManager","instantiate","obstacleManager","constructor","obstaclemanager","thisroadName","playerManager","currentRoad","multiplexRoad","cloneName","leftRoad","rightRoad","IsMoving","RoadController","getInstance","instance","setRoadControllerClass","e","setIsMoving","n","isMoving","leftR","rightR","initSetRoad","prefab","segmentCount","isCharacterPosition","parentNode","i","segment","addChild","setPosition","z","push","randomoObstacle","setRoads","shift","worldPosition","children","removeAllChildren","currentroad","setRoadName","name","RoadName","saveName"],"mappings":"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","sourcesContent":["//道路全局管理器\r\nimport { Prefab, Vec3, instantiate, Node } from \"cc\";\r\nimport { obstacleManager } from \"./ObstacleManager\";\r\nimport { PlayerManager } from \"./PlayerManager\";\r\nimport { RoadController } from \"../controllers/RoadController\";\r\n\r\nexport class RoadManager {\r\n    private static instance: RoadManager;\r\n    obstaclemanager: obstacleManager;\r\n    private thisroadName: String;\r\n    private playerManager: PlayerManager;\r\n    //生成三个或四个道路\r\n    private currentRoad: Array<Node> = [];//当前道路 把第一个拿出来变成可复用道路\r\n    private multiplexRoad;//可复用道路\r\n    public cloneName: String;\r\n    private leftRoad;\r\n    private rightRoad;\r\n    IsMoving: Boolean;\r\n    RoadController: RoadController;\r\n\r\n    constructor() {\r\n        this.obstaclemanager = obstacleManager.getInstance();\r\n        this.IsMoving = false\r\n\r\n    }\r\n    public static getInstance(): RoadManager {\r\n        if (!RoadManager.instance) {\r\n            RoadManager.instance = new RoadManager();\r\n        }\r\n        return RoadManager.instance;\r\n    }\r\n\r\n    public set setRoadControllerClass(e) {\r\n        this.RoadController = e;\r\n    }\r\n    public setIsMoving(n) {\r\n        if (this.RoadController) {\r\n            this.RoadController.setIsMoving(n);\r\n        }\r\n        this.IsMoving = this.RoadController.setIsMoving(n);\r\n    }\r\n    public get isMoving() {\r\n        return this.IsMoving;\r\n    }\r\n    public set leftR(e) {\r\n        this.leftRoad = e;\r\n    }\r\n    public set rightR(e) {\r\n        this.rightRoad = e;\r\n    }\r\n    public get leftR() {\r\n        return this.leftRoad;\r\n    }\r\n    public get rightR() {\r\n        return this.rightRoad;\r\n    }\r\n\r\n\r\n    // 开局初始化并分配所有道路\r\n    initSetRoad(prefab: Prefab, segmentCount: number, isCharacterPosition: Vec3, parentNode: Node) {\r\n        for (let i = 0; i < segmentCount; i++) {\r\n            const segment = instantiate(prefab);\r\n            parentNode.addChild(segment);\r\n            segment.setPosition(0, 0, isCharacterPosition.z + i * 384);\r\n            this.currentRoad.push(segment);\r\n            if (i > 0) {\r\n                this.obstaclemanager.randomoObstacle(segment);\r\n            }\r\n        }\r\n    }\r\n\r\n    setRoads() {\r\n        //玩家每走到第二个道就删掉第一个放入到复用里\r\n        this.multiplexRoad = this.currentRoad[0];\r\n        this.currentRoad.shift();\r\n        this.multiplexRoad.setPosition(0, 0, this.currentRoad[0].worldPosition.z + 1152);\r\n        this.currentRoad.push(this.multiplexRoad);\r\n        let children = this.multiplexRoad.children[3];\r\n        if (children) {\r\n            children.removeAllChildren()\r\n        }\r\n        this.obstaclemanager.randomoObstacle(this.multiplexRoad);\r\n        \r\n    }\r\n\r\n    \r\n\r\n    public get currentroad(): Array<Node> {\r\n        return this.currentRoad;\r\n    }\r\n\r\n    setRoadName(name: String = null) {\r\n        if (name) { this.RoadName = name };\r\n        if (this.RoadName == 'road') {\r\n            this.leftR = this.currentroad[0].children[1];\r\n            this.rightR = this.currentroad[0].children[2];\r\n        } else if (this.RoadName == 'roadLeft') {\r\n            this.leftR = null;\r\n            this.rightR = this.currentroad[0].children[0];\r\n        } else if (this.RoadName == 'roadRight') {\r\n            this.leftR = this.currentroad[0].children[0];\r\n            this.rightR = null;\r\n        }\r\n    }\r\n\r\n    saveName(e) {\r\n        this.cloneName = this.thisroadName;\r\n        this.thisroadName = e.name;\r\n    }\r\n\r\n    public get RoadName() {\r\n        return this.thisroadName;\r\n    }\r\n    public set RoadName(e) {\r\n        this.thisroadName = e;\r\n    }\r\n}"]}